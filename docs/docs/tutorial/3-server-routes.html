<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3. Server Routes - Stackpress Tutorial</title><meta name="description" content="How to add a page route to your application and how a view can optionally consume the response."/><meta property="og:title" content="3. Server Routes - Stackpress Tutorial"/><meta property="og:image" content="/images/icon.png"/><meta property="og:url" content="/docs/tutorial/3-server-routes"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="3. Server Routes - Stackpress Tutorial"/><meta name="twitter:image" content="/images/icon.png"/><link rel="icon" type="image/x-icon" href="/favicon.ico"/><link rel="stylesheet" type="text/css" href="/styles/global.css"/><link rel="stylesheet" type="text/css" href="/assets/3-server-routes-DZMgo4S8.css"/>
  </head>
  <body>
    <div id="root"><link rel="preload" as="image" href="/icon.png"/><div class="dark relative overflow-hidden px-w-100-0 px-h-100-0 theme-bg-bg0 theme-tx1"><header class="theme-bg-bg1 duration-200 absolute px-h-60 px-r-0 px-t-0 px-l-220 rmd-px-l-0"><div class="flex items-center px-px-20 px-h-100-0"><button class="theme-tx1 md-hidden b-0 p-0 bg-transparent text-xl"><i class="fas fa-bars"></i></button><div class="flex-grow"></div><button class="flex justify-center items-center b-0 px-mr-10 px-h-26 px-w-26 px-fs-18 rounded-full text-white bg-gray-600"><i class="fas fa-moon"></i></button></div></header><aside class="duration-200 flex flex-col px-h-100-0 px-z-100 absolute px-w-220 px-b-0 px-l-0 px-t-0 rmd-px-l--220"><header class="px-p-10 px-h-60 flex items-center theme-bg-bg0"><h3 class="flex-grow px-m-0"><a class="theme-tx1 flex items-center no-underline" href="/"><img src="/icon.png" class="px-w-40 px-h-40 px-mr-10"/><span class="uppercase px-fs-16">Stackpress</span></a></h3><button class="theme-tx1 md-hidden b-0 p-0 bg-transparent text-xl"><i class="fas fa-chevron-left"></i></button></header><main class="theme-bg-bg1 flex-grow overflow-auto px-pt-10 px-pb-40"><div><a class="theme-muted block px-py-10 px-pl-20" href="/docs/introduction">Introduction</a><a class="theme-muted block px-py-10 px-pl-20" href="/docs/getting-started">Getting Started</a><a class="theme-tx1 block px-py-10 px-pl-20 font-bold" href="/docs/tutorial">Tutorial</a></div><div><a href="/docs/develop/configure-project" class="theme-tx1 theme-bg-bg2 theme-bc-bd1 font-semibold px-fs-16 uppercase px-mb-0 px-mt-0 px-py-12 px-px-20 flex items-center"><span class="flex-grow">Develop</span><i class="theme-muted px-fs-12 fas fa-caret-left"></i></a></div><div><a href="/docs/transform/form-idea" class="theme-tx1 theme-bg-bg2 theme-bc-bd1 font-semibold px-fs-16 uppercase px-mb-0 px-mt-0 px-py-12 px-px-20 flex items-center"><span class="flex-grow">Transform</span><i class="theme-muted px-fs-12 fas fa-caret-left"></i></a></div><div><a href="/docs/toolkit/setup" class="theme-tx1 theme-bg-bg2 theme-bc-bd1 font-semibold px-fs-16 uppercase px-mb-0 px-mt-0 px-py-12 px-px-20 flex items-center"><span class="flex-grow">Toolkit</span><i class="theme-muted px-fs-12 fas fa-caret-left"></i></a></div><div><a href="/docs/references/client-api" class="theme-tx1 theme-bg-bg2 theme-bc-bd1 font-semibold px-fs-16 uppercase px-mb-0 px-mt-0 px-py-12 px-px-20 flex items-center"><span class="flex-grow">References</span><i class="theme-muted px-fs-12 fas fa-caret-left"></i></a></div></main></aside><aside class="duration-200 absolute px-w-220 px-b-0 px-t-0 px-t-60 px-z-100 px-r-0 rlg-hidden"><div class="px-h-100-0 theme-bg-bg3 flex flex-col"><menu class="px-m-0 px-px-10 px-py-20 overflow-auto"><h6 class="theme-muted px-fs-14 px-mb-0 px-mt-0 px-pb-10 uppercase">On this page</h6><nav class="px-fs-14 px-lh-32"><a class="theme-tx1 block" href="#add-page-route">3.1. Add Page Route</a><a class="theme-tx1 block" href="#register-page-route">3.2. Register Page Route</a><a class="theme-tx1 block" href="#consume-page-route">3.3. Consume Page Route</a><a class="theme-tx1 block" href="#check-page-route">3.4. Check Page Route</a><a class="theme-tx1 block" href="#checkpoint">3.5. Check Point</a></nav></menu></div></aside><main class="theme-bg-bg0 duration-200 absolute px-b-0 px-t-60 px-l-220 rmd-px-l-0 px-r-220 rlg-px-r-0"><article class="px-h-100-0 overflow-auto px-px-20 px-pb-20 px-fs-15"><h2 class="px-fs-16 font-bold px-pt-40">Recap</h2><section><div class="px-lh-30 px-py-20 block">The last section covered a basic <strong class="font-bold">plugin architecture</strong>, designed to separate the project code by unit feature and allowing developers to progressively toggle each one at any given time. Get caught up by making sure your project looks like the following.</div><div class="relative px-h-400 px-fs-13"><div class="theme-bg-bg2 px-lh-30 absolute px-t-0 px-b-0 flex flex-col rsm-hidden px-w-140"><div class="px-p-5">PROJECT</div><div class="flex-grow overflow-auto px-pb-20"><div class="flex items-center" style="padding-left:5px"><i class="inline-block px-fs-10 px-mr-5 fas fa-chevron-down"></i>config</div><div class=" cursor-pointer flex items-center" style="padding-left:20px"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>develop.ts</div><div class="flex items-center" style="padding-left:5px"><i class="inline-block px-fs-10 px-mr-5 fas fa-chevron-down"></i>plugins</div><div class="flex items-center" style="padding-left:20px"><i class="inline-block px-fs-10 px-mr-5 fas fa-chevron-down"></i>app</div><div class="flex items-center" style="padding-left:35px"><i class="inline-block px-fs-10 px-mr-5 fas fa-chevron-down"></i>views</div><div class=" cursor-pointer flex items-center" style="padding-left:50px"><i class="inline-block px-fs-10 px-mr-5 fab fa-react"></i>home.tsx</div><div class=" cursor-pointer flex items-center" style="padding-left:35px"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>plugin.ts</div><div class="theme-bg-bg1 cursor-pointer flex items-center" style="padding-left:5px"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>package.json</div><div class=" cursor-pointer flex items-center" style="padding-left:5px"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>tsconfig.json</div></div></div><div class="theme-bg-bg3 overflow-x-auto absolute px-r-0 px-t-0 px-h-34 rsm-px-l-0 px-l-140"><div class="flex px-pt-5 px-px-3"><div class="theme-bg-bg1 px-mr-3 px-py-5 px-px-16 inline-block whitespace-nowrap cursor-pointer"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>develop.ts</div><div class="theme-bg-bg1 px-mr-3 px-py-5 px-px-16 inline-block whitespace-nowrap cursor-pointer"><i class="inline-block px-fs-10 px-mr-5 fab fa-react"></i>home.tsx</div><div class="theme-bg-bg1 px-mr-3 px-py-5 px-px-16 inline-block whitespace-nowrap cursor-pointer"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>plugin.ts</div><div class="bg-black text-white px-mr-3 px-py-5 px-px-16 inline-block whitespace-nowrap cursor-pointer"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>package.json</div><div class="theme-bg-bg1 px-mr-3 px-py-5 px-px-16 inline-block whitespace-nowrap cursor-pointer"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>tsconfig.json</div></div></div><div class="hidden rsm-px-l-0 bg-black text-white overflow-auto !absolute px-r-0 px-b-0 px-t-34 px-l-140" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div><div class="hidden rsm-px-l-0 bg-black text-white overflow-auto !absolute px-r-0 px-b-0 px-t-34 px-l-140" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div><div class="hidden rsm-px-l-0 bg-black text-white overflow-auto !absolute px-r-0 px-b-0 px-t-34 px-l-140" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div><div class=" rsm-px-l-0 bg-black text-white overflow-auto !absolute px-r-0 px-b-0 px-t-34 px-l-140" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div><div class="hidden rsm-px-l-0 bg-black text-white overflow-auto !absolute px-r-0 px-b-0 px-t-34 px-l-140" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div></div><div class="px-lh-30 px-py-20 block">If you are all caught up, then you can proceed to the next section.</div></section><h1 class="px-fs-24 font-bold px-pt-40 px-pb-20">3. Server Routes</h1><div class="px-lh-30 px-py-20 block">The following section wil continue exploring the possibilities demonstrated within the <span class="inline"><span class="theme-tx1 theme-bg-bg2 inline-block px-px-6 rounded px-lh-24">app</span></span> plugin by adding a page route to the project and how a view can consume the response. Page routes are a type of server route and server routes are also used to develop API endpoints.</div><a id="add-page-route"></a><h2 class="px-fs-16 font-bold px-pt-40">3.1. Add Page Route</h2><section><div class="px-lh-30 px-py-20 block">From the project root, create a file called <span class="inline"><span class="theme-tx1 theme-bg-bg2 inline-block px-px-6 rounded px-lh-24">plugins/app/pages/home.ts</span></span> with the following code.</div><div class="bg-black text-white px-mb-20 px-fs-13" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div><div class="px-lh-30 px-py-20 block">This basically consumes the data from the request. Data from a request is a merge of query params, POST data, and URL params respectively. Consider the following request.</div><div class="bg-black text-white px-mb-20 px-fs-13" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div><div class="px-lh-30 px-py-20 block">In the example above, assuming the requested pathname is <!-- -->, the return of <!-- --> will be computed as <!-- --> where as URL params has priority over POST data which has priority over query params. Lastly, the <!-- --> is passed to the response via <!-- -->.</div></section><a id="register-page-route"></a><h2 class="px-fs-16 font-bold px-pt-40">3.2. Register Page Route</h2><section><div class="px-lh-30 px-py-20 block">Next let&#x27;s change the <span class="inline"><span class="theme-tx1 theme-bg-bg2 inline-block px-px-6 rounded px-lh-24">plugins/app/plugin.ts</span></span> file with the following code.</div><div class="bg-black text-white px-mb-20 px-fs-13" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div><div class="px-lh-30 px-py-20 block">Now in the <!-- --> handler a route has been added that will lazily load the page when the path <!-- --> is requested. Similar to React suspense loading, the reason why lazily loading page routes is recommended is because it will allow bundlers to theoretically analyze the code and possibly split it into smaller chunks. We also want to de-prioritize the <!-- --> view by adding a <!-- --> priority to ensure it loads last. This allows other plugins to inject themselves in the routing phase.</div><div class="frui-alert frui-curved frui-solid frui-thin frui-bd-info frui-tx-info px-lh-28"><i class="inline-block px-mr-5 fas fa-info-circle"></i><strong class="font-bold">NOTE:</strong> <!-- -->You could also use the traditional <!-- --> in your <span class="inline"><span class="theme-tx1 theme-bg-bg2 inline-block px-px-6 rounded px-lh-24">plugins/app/pages/home.ts</span></span> to render the view, but the Plugin Architecture encourages decoupling the view from the page route. This way, you can progressively toggle everything in the <span class="inline"><span class="theme-tx1 theme-bg-bg2 inline-block px-px-6 rounded px-lh-24">plugins/app/plugin.ts</span></span> file.</div></section><a id="consume-page-route"></a><h2 class="px-fs-16 font-bold px-pt-40">3.3. Consume Page Route</h2><section><div class="px-lh-30 px-py-20 block">To consume the <!-- --> in the view, you can use the <!-- --> argument in the following way.</div><div class="bg-black text-white px-mb-20 px-fs-13" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div></section><a id="check-page-route"></a><h2 class="px-fs-16 font-bold px-pt-40">3.4. Check Page Route</h2><section><ol class="px-px-10 px-lh-30 px-py-20"><li>1. In Terminal, restart </li><li>2. On your browser, visit <span class="inline"><span class="theme-tx1 theme-bg-bg2 inline-block px-px-6 rounded px-lh-24">http://localhost:3000/</span></span></li><li>3. Then, visit <span class="inline"><span class="theme-tx1 theme-bg-bg2 inline-block px-px-6 rounded px-lh-24">http://localhost:3000/?json</span></span></li><li>4. Then, visit <span class="inline"><span class="theme-tx1 theme-bg-bg2 inline-block px-px-6 rounded px-lh-24">http://localhost:3000/api/home</span></span></li></ol><div class="px-lh-30 px-py-20 block">You should observe that by adding the <!-- --> flag you can check the server props being sent to your view. This is different from <span class="inline"><span class="theme-tx1 theme-bg-bg2 inline-block px-px-6 rounded px-lh-24">/api/home</span></span> where the home page route is treated as an API endpoint.</div></section><a id="checkpoint"></a><h2 class="px-fs-16 font-bold px-pt-40">3.5. Check Point</h2><section><div class="px-lh-30 px-py-20 block">In case you got lost along the way, here is a checkpoint of what your project should look like.</div><div class="relative px-h-400 px-fs-13"><div class="theme-bg-bg2 px-lh-30 absolute px-t-0 px-b-0 flex flex-col rsm-hidden px-w-140"><div class="px-p-5">PROJECT</div><div class="flex-grow overflow-auto px-pb-20"><div class="flex items-center" style="padding-left:5px"><i class="inline-block px-fs-10 px-mr-5 fas fa-chevron-down"></i>config</div><div class=" cursor-pointer flex items-center" style="padding-left:20px"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>develop.ts</div><div class="flex items-center" style="padding-left:5px"><i class="inline-block px-fs-10 px-mr-5 fas fa-chevron-down"></i>plugins</div><div class="flex items-center" style="padding-left:20px"><i class="inline-block px-fs-10 px-mr-5 fas fa-chevron-down"></i>app</div><div class="flex items-center" style="padding-left:35px"><i class="inline-block px-fs-10 px-mr-5 fas fa-chevron-down"></i>pages</div><div class=" cursor-pointer flex items-center" style="padding-left:50px"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>home.ts</div><div class="flex items-center" style="padding-left:35px"><i class="inline-block px-fs-10 px-mr-5 fas fa-chevron-down"></i>views</div><div class="theme-bg-bg1 cursor-pointer flex items-center" style="padding-left:50px"><i class="inline-block px-fs-10 px-mr-5 fab fa-react"></i>home.tsx</div><div class=" cursor-pointer flex items-center" style="padding-left:35px"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>plugin.ts</div><div class=" cursor-pointer flex items-center" style="padding-left:5px"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>package.json</div><div class=" cursor-pointer flex items-center" style="padding-left:5px"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>tsconfig.json</div></div></div><div class="theme-bg-bg3 overflow-x-auto absolute px-r-0 px-t-0 px-h-34 rsm-px-l-0 px-l-140"><div class="flex px-pt-5 px-px-3"><div class="theme-bg-bg1 px-mr-3 px-py-5 px-px-16 inline-block whitespace-nowrap cursor-pointer"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>develop.ts</div><div class="theme-bg-bg1 px-mr-3 px-py-5 px-px-16 inline-block whitespace-nowrap cursor-pointer"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>home.ts</div><div class="bg-black text-white px-mr-3 px-py-5 px-px-16 inline-block whitespace-nowrap cursor-pointer"><i class="inline-block px-fs-10 px-mr-5 fab fa-react"></i>home.tsx</div><div class="theme-bg-bg1 px-mr-3 px-py-5 px-px-16 inline-block whitespace-nowrap cursor-pointer"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>plugin.ts</div><div class="theme-bg-bg1 px-mr-3 px-py-5 px-px-16 inline-block whitespace-nowrap cursor-pointer"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>package.json</div><div class="theme-bg-bg1 px-mr-3 px-py-5 px-px-16 inline-block whitespace-nowrap cursor-pointer"><i class="inline-block px-fs-10 px-mr-5 fas fa-file"></i>tsconfig.json</div></div></div><div class="hidden rsm-px-l-0 bg-black text-white overflow-auto !absolute px-r-0 px-b-0 px-t-34 px-l-140" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div><div class="hidden rsm-px-l-0 bg-black text-white overflow-auto !absolute px-r-0 px-b-0 px-t-34 px-l-140" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div><div class=" rsm-px-l-0 bg-black text-white overflow-auto !absolute px-r-0 px-b-0 px-t-34 px-l-140" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div><div class="hidden rsm-px-l-0 bg-black text-white overflow-auto !absolute px-r-0 px-b-0 px-t-34 px-l-140" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div><div class="hidden rsm-px-l-0 bg-black text-white overflow-auto !absolute px-r-0 px-b-0 px-t-34 px-l-140" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div><div class="hidden rsm-px-l-0 bg-black text-white overflow-auto !absolute px-r-0 px-b-0 px-t-34 px-l-140" style="position:relative"><div style="text-align:right;padding:10px 10px 0 0;color:inherit;cursor:pointer;white-space:nowrap"><span>❐</span> Copy</div></div></div><div class="px-lh-30 px-py-20 block">The next section will cover how server props works, how to send custom template data and how the view consumes it.</div></section><nav class="flex"><a class="theme-primary px-py-40" href="/docs/tutorial/2-plugin-architecture"><i class="fas fa-fw fa-chevron-left"></i>2. Plugin Architecture</a><a class="theme-primary flex-grow text-right px-py-40" href="/docs/tutorial/4-server-props">4. Server Props<i class="fas fa-fw fa-chevron-right"></i></a></nav></article></main></div><section class="Toastify" aria-live="polite" aria-atomic="false" aria-relevant="additions text" aria-label="Notifications Alt+T"></section></div>
    <script id="props" type="text/json">{"data":{"view":{"base":"/","props":{}},"brand":{"name":"Stackpress","logo":"/logo.png","icon":"/icon.png","favicon":"/favicon.ico"},"language":{"key":"locale","locale":"en_US","languages":{"en_US":{"label":"EN","translations":{"Sign In":"Signin","Home Page":"Home Page"}},"th_TH":{"label":"TH","translations":{"Sign In":"Signin","Home Page":"Home Pagesss"}}}}},"session":{"id":0,"roles":["GUEST"],"token":"","permits":[{"method":"ALL","route":"/**"}]},"request":{"url":{"hash":"","host":"www.stackpress.io","hostname":"www.stackpress.io","href":"https://www.stackpress.io/docs/tutorial/3-server-routes","origin":"https://www.stackpress.io","pathname":"/docs/tutorial/3-server-routes","port":"","protocol":"https:","search":""},"headers":{},"session":{},"method":"GET","mime":"text/plain","data":{"0":"tutorial","1":"3-server-routes"}},"response":{"code":200,"status":"OK","errors":{},"results":null,"total":0}}</script>
    <script type="module" src="/client/3-server-routes-cRnkJKmi.js"></script>
  </body>
</html>